<report
    title="HORUS quality indices"
    description="List of selectable HORUS quality indices for a sample."
    >
  <query>
    select #columns#
    from taxa_taxon_list_attributes ttla
    join taxa_taxon_list_attribute_values ttlav on ttlav.taxa_taxon_list_attribute_id=ttla.id and ttlav.deleted=false
    join cache_occurrences_functional o on o.preferred_taxa_taxon_list_id=ttlav.taxa_taxon_list_id
    where ttla.description='Pantheon quality indices'
    and o.sample_id=#sample_id#
    and ttla.deleted=false
  </query>
  <order_bys>
    <order_by>ttla.description ASC</order_by>
  </order_bys>
  <params>
    <param name='sample_id' display='Sample ID'  datatype='integer'/>
  </params>
  <columns>
    <column name="id" sql="ttla.id" display="Attribute ID" />
    <column name="caption" sql="ttla.caption" display="Quality index" />
    <column name="count" sql="count(distinct o.preferred_taxa_taxon_list_id)" display="Count" aggregate="true" />
  </columns>
</report>